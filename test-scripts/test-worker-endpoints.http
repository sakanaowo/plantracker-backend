### Test Worker Endpoints
### Requires: REST Client extension in VS Code

### Variables
@baseUrl = http://localhost:3000/api
@workerToken = d95ba7370e00396b849410720f26f1cefcb935ede76338cb51c8529a5c15d400

### ============================================
### 1. Health Check Endpoint
### Test if worker endpoints are accessible
### ============================================

POST {{baseUrl}}/worker/health
Content-Type: application/json
Authorization: Bearer {{workerToken}}

### Expected Response:
### {
###   "status": "healthy",
###   "timestamp": "2025-10-21T...",
###   "service": "worker"
### }


### ============================================
### 2. Test Upcoming Task Reminders
### This will send notifications for tasks due within 24 hours
### ============================================

POST {{baseUrl}}/worker/upcoming-reminders
Content-Type: application/json
Authorization: Bearer {{workerToken}}

### Expected Response:
### {
###   "job": "upcoming-reminders",
###   "timestamp": "2025-10-21T...",
###   "success": true,
###   "sent": 5,
###   "failed": 0
### }


### ============================================
### 3. Test Overdue Task Reminders
### This will send notifications for overdue tasks
### ============================================

POST {{baseUrl}}/worker/overdue-reminders
Content-Type: application/json
Authorization: Bearer {{workerToken}}

### Expected Response:
### {
###   "job": "overdue-reminders",
###   "timestamp": "2025-10-21T...",
###   "success": true,
###   "sent": 3,
###   "failed": 0
### }


### ============================================
### 4. Test Daily Summary
### This will send daily summary to all users with active tasks
### ============================================

POST {{baseUrl}}/worker/daily-summary
Content-Type: application/json
Authorization: Bearer {{workerToken}}

### Expected Response:
### {
###   "job": "daily-summary",
###   "timestamp": "2025-10-21T...",
###   "success": true,
###   "sent": 10,
###   "failed": 0
### }


### ============================================
### 5. Test Unauthorized Access (No Token)
### Should return 401 Unauthorized
### ============================================

POST {{baseUrl}}/worker/health
Content-Type: application/json

### Expected Response:
### {
###   "statusCode": 401,
###   "message": "Invalid worker token",
###   "error": "Unauthorized"
### }


### ============================================
### 6. Test Unauthorized Access (Wrong Token)
### Should return 401 Unauthorized
### ============================================

POST {{baseUrl}}/worker/health
Content-Type: application/json
Authorization: Bearer wrong_token_12345

### Expected Response:
### {
###   "statusCode": 401,
###   "message": "Invalid worker token",
###   "error": "Unauthorized"
### }
